---
/**
 * PinnedStory — Sección sticky tipo Apple
 * - Imagen fija que escala con el scroll (CSS scroll-driven).
 * - Bloques de texto que se "encienden" por turnos mientras avanzas.
 * - Si el navegador no soporta scroll-driven, tendrás fallback con GSAP (lo añadimos en el paso 7.3).
 */
const steps = [
  { title: "El detalle importa", text: "Microtexturas, escamas, ojos compuestos: donde empieza la historia." },
  { title: "Luz y paciencia",   text: "Esperar el gesto justo. Control de reflejos y profundidad mínima." },
  { title: "Respeto al entorno", text: "Distancia, cero molestia y mínima huella. La foto nunca por encima." },
];
---
<section class="sticky-wrap" aria-label="Historia visual">
  <div class="sticky">
    <div class="container pin-grid">
      <!-- Imagen fijada que escala -->
      <figure class="pin-visual shadow">
        <!-- Puedes cambiar a otra imagen: /photos/pinned.webp -->
        <img
          src="/photos/hero.webp"
          alt="Secuencia principal de la historia visual"
          width="2560"
          height="1440"
          loading="eager"
        />
      </figure>

      <!-- Texto que cambia por pasos -->
      <div class="pin-steps">
        {steps.map((s, i) => (
          <article class="pin-step" style={`--i:${i}`}>
            <h3 class="pin-title">{s.title}</h3>
            <p class="lead" style="margin:.4rem 0 0 0">{s.text}</p>
          </article>
        ))}
      </div>
    </div>
  </div>

  <style>
    /* Grid responsive para imagen + texto */
    .pin-grid {
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap: clamp(18px,3vw,36px);
      align-items:center;
    }
    @media (max-width: 900px){ .pin-grid { grid-template-columns: 1fr; } }

    /* Imagen que escala con el scroll */
    .pin-visual {
      view-timeline-name: --pin;
      view-timeline-axis: block;
      animation-timeline: --pin;
      animation-name: pin-zoom;
      animation-range: entry 0% cover 80%;
      animation-fill-mode: both;
      overflow: clip;
      border-radius: var(--radius);
    }
    .pin-visual img { display:block; width:100%; height:auto; transform-origin:center; }

    @keyframes pin-zoom {
      from { transform: scale(0.92); opacity:.92; }
      to   { transform: scale(1.12); opacity:1; }
    }

    /* Pasos de texto: cada uno se enciende en su tramo */
    .pin-steps { display:flex; flex-direction:column; gap: clamp(18px,2.2vw,28px); }
    .pin-step {
      view-timeline-name: --pin;
      view-timeline-axis: block;
      animation-timeline: --pin;
      animation-name: fade-in-out;
      animation-fill-mode: both;

      /* Tres pasos → cada uno ocupa ~un tercio del recorrido */
      animation-range: entry calc(var(--i,0)*33%) cover calc((var(--i,0)+1)*33%);
      opacity:.25;
    }

    @keyframes fade-in-out {
      0%   { opacity:.15; transform: translateY(8px); }
      35%  { opacity:1;   transform: translateY(0); }
      65%  { opacity:1;   transform: translateY(0); }
      100% { opacity:.15; transform: translateY(-8px); }
    }

    .pin-title { font-weight: 700; letter-spacing:.2px; }
  </style>
</section>
