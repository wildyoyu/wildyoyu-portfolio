---
import { getCollection } from 'astro:content';
const latest = (await getCollection('shots'))
  .sort((a,b)=> new Date(b.data.date||0) - new Date(a.data.date||0))
  .reverse()
  .slice(0,3)
  .map(({ slug, data }) => ({
    slug,
    title: data.title || '',
    alt: data.alt || '',
    src: data.src,
    w: data.w, h: data.h,
  }));
---
<section class="section" aria-label="GalerÃ­a destacada">
  <div class="container" style="display:grid; gap: clamp(18px, 2vw, 28px);">
    {latest.map((it) => (
      <article class="parallax-card card" role="figure" aria-label={it.alt} style="padding: clamp(10px,1.5vw,16px);">
        <button
          class="lb-trigger"
          type="button"
          aria-label={`Abrir ${it.title} a pantalla completa`}
          data-src={it.src}
          data-alt={it.alt}
          data-title={it.title}
          data-slug={it.slug}
          style="display:block; width:100%; padding:0; margin:0; border:0; background:none; cursor:zoom-in;"
        >
          <img
            src={it.src}
            alt={it.alt}
            loading="lazy"
            width={it.w}
            height={it.h}
            style="border-radius: calc(var(--radius) - 6px); aspect-ratio: 16 / 10; object-fit: cover; display:block; width:100%; height:auto;"
          />
        </button>
        <header style="padding: .8rem 1rem 1.2rem 1rem;">
          <h3 style="margin:0; font-weight:600; letter-spacing:.2px">{it.title}</h3>
        </header>
      </article>
    ))}
  </div>
</section>
